USE world_x;
-- -----------------------------------------------------
-- The names of all the cities in the Netherlands
-- -----------------------------------------------------
SELECT Name
FROM world_x.city
WHERE CountryCode='NLD';
-- -----------------------------------------------------
-- The population of Rotterdam
-- -----------------------------------------------------
SELECT JSON_EXTRACT(info,'$.Population') AS Population
FROM world_x.city
WHERE Name='Rotterdam';
-- -----------------------------------------------------
-- Names of all the countries on the continent ‘North America’
-- -----------------------------------------------------
SELECT JSON_UNQUOTE(JSON_EXTRACT(doc,'$.Name')) AS Name,JSON_UNQUOTE(JSON_EXTRACT(doc,'$.geography.Continent')) AS Continent
FROM world_x.countryinfo
WHERE JSON_EXTRACT(doc,'$.geography.Continent')='North America';
-- -----------------------------------------------------
-- The top 10 countries by SurfaceArea
-- -----------------------------------------------------
SELECT JSON_UNQUOTE(JSON_EXTRACT(doc,'$.Name')) AS Name,JSON_EXTRACT(doc,'$.geography.SurfaceArea') AS SurfaceArea
FROM world_x.countryinfo
ORDER BY JSON_EXTRACT(doc,'$.geography.SurfaceArea') DESC
LIMIT 10;
-- -----------------------------------------------------
-- The top 10 most populated cities
-- -----------------------------------------------------
SELECT Name,JSON_EXTRACT(info,'$.Population') AS Population
FROM world_x.city
ORDER BY JSON_EXTRACT(info,'$.Population') DESC
LIMIT 10;
-- -----------------------------------------------------
-- The top 3 countries by population that their names start with the letter ‘P’
-- -----------------------------------------------------
SELECT JSON_UNQUOTE(JSON_EXTRACT(doc,'$.Name')) N,JSON_EXTRACT(doc,'$.demographics.Population') P
FROM world_x.countryinfo
WHERE JSON_UNQUOTE(JSON_EXTRACT(doc,'$.Name')) LIKE 'P%'
ORDER BY P DESC
LIMIT 3;
-- -----------------------------------------------------
-- Total population of Asian countries
-- -----------------------------------------------------
SELECT SUM(JSON_EXTRACT(doc,'$.demographics.Population'))
FROM world_x.countryinfo
WHERE JSON_EXTRACT(doc,'$.geography.Continent')='Asia';
-- -----------------------------------------------------
-- The languages that are spoken in the Region of ‘South America’
-- -----------------------------------------------------
SELECT DISTINCT
 Language
FROM world_x.countrylanguage AS cl
LEFT JOIN world_x.countryinfo AS ci ON cl.CountryCode=ci._id
WHERE JSON_EXTRACT(doc,'$.geography.Region')='South America';
-- -----------------------------------------------------
-- The languages that are spoken on all cities named ‘Barcelona’
-- -----------------------------------------------------
SELECT DISTINCT
 Language
FROM world_x.city AS c
LEFT JOIN world_x.countrylanguage AS cl ON c.CountryCode=cl.countrycode
WHERE c.Name='Barcelona';