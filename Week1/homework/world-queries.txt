-- -----------------------------------------------------
-- The names of all the cities in the Netherlands
-- -----------------------------------------------------
USE world_x;
SELECT
  Name
FROM
  city
WHERE
  CountryCode = 'NLD';
-- -----------------------------------------------------
-- The population of Rotterdam
-- -----------------------------------------------------
  USE world_x;
SELECT
  info ->> '$.Population' as Population
FROM
  city
WHERE
  Name = 'Rotterdam' 
-- -----------------------------------------------------
-- Names of all the countries on the continent ‘North America’
-- -----------------------------------------------------
  USE world_x;
SELECT
  doc ->> '$.Name' AS Name,
  doc ->> '$.geography.Continent' AS Continent
FROM
  countryinfo
WHERE
  doc -> '$.geography.Continent' = 'North America' 
-- -----------------------------------------------------
-- The top 10 countries by SurfaceArea
-- -----------------------------------------------------
  USE world_x;
SELECT
  doc ->> '$.Name' AS Name,
  doc ->> '$.geography.SurfaceArea' AS SurfaceArea
FROM
  countryinfo
ORDER BY
  doc -> '$.geography.SurfaceArea' DESC
LIMIT
  10 
-- -----------------------------------------------------
-- The top 10 most populated cities
-- -----------------------------------------------------
  USE world_x;
SELECT
  Name,
  info ->> '$.Population' AS Population
FROM
  city
ORDER BY
  info -> '$.Population' DESC
LIMIT
  10 
-- -----------------------------------------------------
-- The top 3 countries by population that their names start with the letter ‘P’
-- -----------------------------------------------------
  USE world_x;
SELECT
  doc ->> '$.Name' AS Name,
  doc ->> '$.demographics.Population' AS Population
FROM
  countryinfo
WHERE
  doc ->> '$.Name' LIKE 'P%'
ORDER BY
  doc -> '$.demographics.Population' DESC
LIMIT
  3 
-- -----------------------------------------------------
-- Total population of Asian countries
-- -----------------------------------------------------
  USE world_x;
SELECT
  sum(doc ->> '$.demographics.Population') AS Population
FROM
  countryinfo
WHERE
  doc -> '$.geography.Continent' = 'Asia' USE world_x;
-- -----------------------------------------------------
-- The languages that are spoken in the Region of ‘South America’
-- -----------------------------------------------------
SELECT
  Language
FROM
  countrylanguage,
  countryinfo
WHERE
  countrylanguage.countrycode = doc ->> '$._id'
  AND doc ->> '$.geography.Region' = 'South America'
group by
  Language 
-- -----------------------------------------------------
-- The languages that are spoken on all cities named ‘Barcelona’
-- -----------------------------------------------------
  USE world_x;
SELECT
  Language
FROM
  countrylanguage,
  city
WHERE
  countrylanguage.countrycode = city.CountryCode
  AND city.Name = 'Barcelona'
GROUP BY
  Language